<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assessment Questions | Voss AI Opportunity Scorecard</title>
    <meta name="description" content="Complete your AI readiness assessment questionnaire">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            text-align: center;
            transition: all 0.2s;
            border-radius: 0.375rem;
            outline: none;
            border: none;
            cursor: pointer;
        }
        .btn:focus {
            box-shadow: 0 0 0 2px rgba(0, 191, 165, 0.5), 0 0 0 4px rgba(0, 191, 165, 0.25);
        }
        .btn-primary {
            color: white;
            background-color: #00BFA5;
        }
        .btn-primary:hover {
            background-color: #009B8D;
        }
        .btn-outline {
            color: #374151;
            background-color: white;
            border: 1px solid #d1d5db;
        }
        .btn-outline:hover {
            background-color: #f9fafb;
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .progress-container {
            width: 100%;
            height: 0.5rem;
            background-color: #e5e7eb;
            border-radius: 9999px;
        }
        .progress-bar {
            height: 0.5rem;
            border-radius: 9999px;
            background-color: #00BFA5;
            transition: all 0.3s;
        }
        
        .question-card {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background-color: white;
            border-radius: 0.75rem;
            border-left: 4px solid #00BFA5;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .likert-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .likert-option {
            padding: 0.75rem 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            border-radius: 0.5rem;
            border: 2px solid transparent;
            transition: all 0.2s;
            cursor: pointer;
            text-align: center;
            position: relative;
            min-height: 65px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #f8fafc;
            border-color: #e2e8f0;
            color: #475569;
        }
        
        .likert-option:hover {
            background-color: #f1f5f9;
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }
        
        .likert-option.selected {
            background-color: #00BFA5;
            border-color: #00BFA5;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 191, 165, 0.3);
        }
        
        /* Mobile improvements */
        @media (max-width: 768px) {
            .likert-container {
                grid-template-columns: repeat(5, 1fr);
                gap: 0.25rem;
            }
            .likert-option {
                padding: 0.5rem 0.125rem;
                font-size: 0.625rem;
                min-height: 55px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <main class="min-h-screen py-12">
        <div class="container mx-auto px-4">
            <div class="max-w-3xl mx-auto">
                <!-- Progress bar -->
                <div class="mb-8">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-gray-700" id="sectionInfo">
                            Section 1 of 6: AI Strategy & Vision
                        </span>
                        <span class="text-sm font-medium text-gray-700" id="progressPercent">
                            0% Complete
                        </span>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                    </div>
                </div>
                
                <!-- Section header -->
                <div class="mb-8 text-center">
                    <h1 class="text-3xl font-bold text-gray-900 mb-2" id="sectionTitle">
                        AI Strategy & Vision
                    </h1>
                    <p class="text-gray-600" id="sectionDescription">
                        Assess your organization's strategic approach to AI adoption
                    </p>
                    <div class="mt-4">
                        <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full" id="questionCount">
                            5 questions
                        </span>
                    </div>
                </div>
                
                <!-- Questions container -->
                <div class="bg-white rounded-lg shadow-md p-6 md:p-8" id="questionsCard">
                    <div id="questionsContainer">
                        <!-- Questions will be dynamically generated here -->
                    </div>
                    
                    <!-- Navigation buttons -->
                    <div class="flex justify-between mt-8">
                        <button
                            type="button"
                            id="prevButton"
                            class="btn btn-outline"
                            disabled
                        >
                            ← Previous
                        </button>
                        <button
                            type="button"
                            id="nextButton"
                            class="btn btn-primary"
                        >
                            Next Section →
                        </button>
                    </div>
                </div>

                <!-- Back to assessment link -->
                <div class="mt-8 text-center">
                    <a href="index.html" class="text-blue-600 hover:text-blue-800">
                        ← Back to User Information
                    </a>
                </div>
            </div>
        </div>
    </main>

    <script>
        console.log('=== ASSESSMENT PAGE STARTING ===');
        
        // Safe localStorage access
        function safeLocalStorage() {
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                return {
                    getItem: function(key) { return localStorage.getItem(key); },
                    setItem: function(key, value) { localStorage.setItem(key, value); },
                    removeItem: function(key) { localStorage.removeItem(key); }
                };
            } catch (e) {
                var memoryStorage = {};
                return {
                    getItem: function(key) { return memoryStorage[key] || null; },
                    setItem: function(key, value) { memoryStorage[key] = value; },
                    removeItem: function(key) { delete memoryStorage[key]; }
                };
            }
        }
        
        var storage = safeLocalStorage();
        var answers = {};
        var currentSection = 0;
        var totalSections = 6;
        
        // Define all sections
        var sections = [
            {
                id: 'strategy',
                title: 'AI Strategy & Vision',
                description: 'Assess your organization\'s strategic approach to AI adoption',
                questions: [
                    { id: 'strategy_vision', text: 'Our organization has a clear, documented vision for how AI will create business value' },
                    { id: 'strategy_problems', text: 'We have identified specific, measurable business problems that AI could help solve' },
                    { id: 'strategy_leadership', text: 'Our leadership team actively champions and supports AI initiatives' },
                    { id: 'strategy_budget', text: 'We have allocated appropriate budget and resources for AI implementation' },
                    { id: 'strategy_culture', text: 'Our organization has a culture that embraces innovation and technological change' }
                ]
            },
            {
                id: 'operations',
                title: 'Operational Readiness',
                description: 'Evaluate how well your operations can integrate AI solutions',
                questions: [
                    { id: 'ops_process_mapping', text: 'We have documented and mapped our key business processes in detail' },
                    { id: 'ops_automation_candidates', text: 'We have identified repetitive, rule-based tasks that could be automated' },
                    { id: 'ops_change_readiness', text: 'Our operational teams are receptive to process changes enabled by AI' },
                    { id: 'ops_efficiency_measurement', text: 'We have clear metrics to measure operational efficiency improvements' }
                ]
            },
            {
                id: 'technology',
                title: 'Technology Infrastructure',
                description: 'Assess your technical readiness for AI implementation',
                questions: [
                    { id: 'tech_infrastructure', text: 'Our current IT infrastructure can support AI applications and workloads' },
                    { id: 'tech_cloud_experience', text: 'We have experience with cloud computing platforms and services' },
                    { id: 'tech_data_systems', text: 'Our data systems are well-integrated and accessible for AI applications' },
                    { id: 'tech_security', text: 'We have robust cybersecurity measures in place for AI systems' }
                ]
            },
            {
                id: 'data',
                title: 'Data Quality & Governance',
                description: 'Evaluate your data readiness for AI applications',
                questions: [
                    { id: 'data_quality', text: 'We have high-quality, well-structured data available for AI projects' },
                    { id: 'data_accessibility', text: 'Our data is well-organized and easily accessible to relevant teams' },
                    { id: 'data_governance', text: 'We have strong data governance policies and procedures in place' },
                    { id: 'data_privacy', text: 'We have clear data privacy and compliance frameworks established' }
                ]
            },
            {
                id: 'culture',
                title: 'Organizational Culture',
                description: 'Assess cultural readiness for AI adoption and change',
                questions: [
                    { id: 'culture_enthusiasm', text: 'Our employees are generally enthusiastic about AI adoption and its potential' },
                    { id: 'culture_change_embrace', text: 'We have a culture that embraces and adapts well to technological change' },
                    { id: 'culture_learning', text: 'Our organization prioritizes continuous learning and skill development' },
                    { id: 'culture_collaboration', text: 'We foster collaboration between technical and business teams' }
                ]
            },
            {
                id: 'automation',
                title: 'Automation Readiness',
                description: 'Identify current automation experience and opportunities',
                questions: [
                    { id: 'auto_current_state', text: 'We have already implemented some form of process automation' },
                    { id: 'auto_employee_understanding', text: 'Our employees understand how automation enhances rather than replaces their work' },
                    { id: 'auto_tools_experience', text: 'We have experience with automation tools and technologies' },
                    { id: 'auto_roi_measurement', text: 'We can measure and demonstrate ROI from automation initiatives' }
                ]
            }
        ];
        
        console.log('Sections defined:', sections.length);
        
        // Load existing answers if any
        try {
            answers = JSON.parse(storage.getItem("voss_answers") || "{}");
            console.log('Loaded existing answers:', answers);
        } catch (e) {
            console.log('No existing answers found');
            answers = {};
        }
        
        // Answer selection function
        function selectAnswer(questionId, value) {
            console.log('Answer selected:', questionId, value);
            
            // Store the answer
            answers[questionId] = value;
            storage.setItem("voss_answers", JSON.stringify(answers));
            
            // Update UI - find the question card and update selection
            var questionCard = document.querySelector('[data-question-id="' + questionId + '"]');
            if (questionCard) {
                // Remove selected class from all buttons in this card
                var buttons = questionCard.querySelectorAll('.likert-option');
                for (var i = 0; i < buttons.length; i++) {
                    buttons[i].classList.remove('selected');
                }
                
                // Add selected class to the clicked button
                var selectedButton = questionCard.querySelector('[data-value="' + value + '"]');
                if (selectedButton) {
                    selectedButton.classList.add('selected');
                }
            }
            
            updateProgress();
        }
        
        // Set up event delegation for button clicks
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('likert-option') || e.target.parentNode.classList.contains('likert-option')) {
                var button = e.target.classList.contains('likert-option') ? e.target : e.target.parentNode;
                var questionCard = button.closest('.question-card');
                if (!questionCard) return;
                
                var questionId = questionCard.getAttribute('data-question-id');
                var value = parseInt(button.getAttribute('data-value'));
                
                if (questionId && !isNaN(value)) {
                    selectAnswer(questionId, value);
                }
            }
        });
        
        // Update progress bar and navigation
        function updateProgress() {
            var section = sections[currentSection];
            var answeredQuestions = 0;
            
            // Count answered questions in current section
            for (var i = 0; i < section.questions.length; i++) {
                if (answers[section.questions[i].id] !== undefined) {
                    answeredQuestions++;
                }
            }
            
            // Calculate overall progress
            var sectionProgress = (currentSection + (answeredQuestions / section.questions.length)) / totalSections;
            var progressPercent = Math.round(sectionProgress * 100);
            
            // Update UI
            document.getElementById('progressBar').style.width = progressPercent + '%';
            document.getElementById('progressPercent').textContent = progressPercent + '% Complete';
            document.getElementById('sectionInfo').textContent = 'Section ' + (currentSection + 1) + ' of ' + totalSections + ': ' + section.title;
            
            // Update navigation buttons
            document.getElementById('prevButton').disabled = currentSection === 0;
            var nextButton = document.getElementById('nextButton');
            if (currentSection === totalSections - 1) {
                nextButton.textContent = 'See Results →';
            } else {
                nextButton.textContent = 'Next Section →';
            }
        }
        
        // Render current section
        function renderSection() {
            console.log('=== RENDERING SECTION ===');
            console.log('Current section index:', currentSection);
            
            var section = sections[currentSection];
            if (!section) {
                console.error('No section found for index:', currentSection);
                return;
            }
            
            console.log('Rendering section:', section.title, 'with', section.questions.length, 'questions');
            
            // Update header
            document.getElementById('sectionTitle').textContent = section.title;
            document.getElementById('sectionDescription').textContent = section.description;
            document.getElementById('questionCount').textContent = section.questions.length + ' questions';
            
            // Build questions HTML
            var questionsHTML = '';
            for (var i = 0; i < section.questions.length; i++) {
                var question = section.questions[i];
                var questionNum = i + 1;
                
                questionsHTML += '<div class="question-card" data-question-id="' + question.id + '">';
                questionsHTML += '<h3 class="text-lg font-medium text-gray-900 mb-4">';
                questionsHTML += '<span class="text-blue-600 font-bold">' + questionNum + '.</span> ';
                questionsHTML += question.text;
                questionsHTML += '<span class="text-red-500 ml-1">*</span>';
                questionsHTML += '</h3>';
                questionsHTML += '<div class="likert-container">';
                
                // Add Likert scale buttons
                var likertLabels = ['Strongly Disagree', 'Disagree', 'Neutral', 'Agree', 'Strongly Agree'];
                for (var j = 0; j < 5; j++) {
                    var isSelected = answers[question.id] === j ? ' selected' : '';
                    questionsHTML += '<button type="button" class="likert-option' + isSelected + '" data-value="' + j + '">';
                    questionsHTML += '<div style="font-weight: 700; font-size: 1rem; margin-bottom: 0.25rem;">' + (j + 1) + '</div>';
                    questionsHTML += '<div style="font-size: 0.65rem; line-height: 1.1; font-weight: 500;">' + likertLabels[j] + '</div>';
                    questionsHTML += '</button>';
                }
                
                questionsHTML += '</div>';
                questionsHTML += '</div>';
            }
            
            console.log('Generated HTML length:', questionsHTML.length);
            
            var container = document.getElementById('questionsContainer');
            if (!container) {
                console.error('questionsContainer element not found!');
                return;
            }
            
            container.innerHTML = questionsHTML;
            console.log('HTML injected into container');
            
            updateProgress();
            console.log('Section rendering completed');
        }
        
        // Handle next button click
        document.getElementById("nextButton").addEventListener("click", function() {
            console.log('Next button clicked, current section:', currentSection);
            
            // Calculate section score based on answers
            var section = sections[currentSection];
            var sectionScore = 0;
            var answeredQuestions = 0;
            
            console.log('Calculating score for section:', section.id);
            
            for (var i = 0; i < section.questions.length; i++) {
                var questionId = section.questions[i].id;
                if (answers[questionId] !== undefined) {
                    var questionScore = (answers[questionId] / 4) * 100; // Convert 0-4 to 0-100
                    sectionScore += questionScore;
                    answeredQuestions++;
                    console.log('Question', questionId, 'answer:', answers[questionId], 'score:', questionScore);
                } else {
                    // Add default answer if none provided
                    answers[questionId] = 2; // Default to "Neutral" for fairness
                    sectionScore += 50; // 2/4 * 100
                    answeredQuestions++;
                    console.log('Question', questionId, 'defaulted to 2 (neutral), score: 50');
                }
            }
            
            // Average the section score
            if (answeredQuestions > 0) {
                sectionScore = Math.round(sectionScore / answeredQuestions);
            }
            
            console.log('Final section score for', section.id, ':', sectionScore);
            
            // Save section score
            var scores = {};
            try {
                scores = JSON.parse(storage.getItem("voss_scores") || "{}");
            } catch (e) {
                scores = {};
            }
            scores[section.id] = sectionScore;
            
            // Save both scores and answers
            storage.setItem("voss_scores", JSON.stringify(scores));
            storage.setItem("voss_answers", JSON.stringify(answers));
            
            console.log('Updated scores object:', scores);
            
            // Move to next section or results
            if (currentSection < totalSections - 1) {
                currentSection++;
                renderSection();
                window.scrollTo(0, 0);
            } else {
                // All sections completed, redirect to results
                console.log('All sections completed, final scores:', scores);
                
                // Double-check data is saved before redirecting
                setTimeout(function() {
                    var savedScores = storage.getItem("voss_scores");
                    var savedAnswers = storage.getItem("voss_answers");
                    console.log('Pre-redirect check - saved scores:', savedScores);
                    console.log('Pre-redirect check - saved answers:', savedAnswers);
                    window.location.href = "results.html";
                }, 100);
            }
        });
        
        // Handle previous button click
        document.getElementById("prevButton").addEventListener("click", function() {
            if (currentSection > 0) {
                currentSection--;
                renderSection();
                window.scrollTo(0, 0);
            }
        });
        
        // Initialize the assessment when DOM is loaded
        console.log('=== ASSESSMENT PAGE INITIALIZATION ===');
        console.log('Sections defined:', sections.length);
        console.log('Current section:', currentSection);
        console.log('Existing answers:', answers);
        
        // Wait for DOM to be ready, then render
        function initializeAssessment() {
            console.log('DOM ready, rendering first section...');
            renderSection();
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeAssessment);
        } else {
            initializeAssessment();
        }
        
        console.log('Assessment setup complete');
    </script>

</body>
</html>